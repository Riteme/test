<br /><center class="subtitle">Fudan ICPC Summer Training Camp 2019</center>

# 牛客网第四场训练报告

<br />

<center>刘明君、孙亮亮、薛振梁</center>
<center>2019 年 7 月 27 日</center>
<br />

### 概况

比赛中通过 6 题，赛后补 4 题，总共通过 10 题。

### 比赛过程

<pre class="replay">
|0        |30       |60       |90       |120      |150      |180      |210      |240      |270      (min)
..................x.D.........................................x.....x..C............................ lmj
.......xxK........x.?...J.................x.....!xx.....x...x...I................................... sll
....................A..........................................................?....x.x.......x..x.b xzl
x: Wrong Answer
?: Time Limit Exceeded / Memory Limit Exceeded
!: Runtime Error
大写字母：Accepted
小写字母：未通过
</pre>

### 总结

**刘明君：**我开场看 D，发现需要分类讨论，讨论好之后写了一发。写完讨论了一下 I 题，就是一个 SA+PAM 的板子题，sll 去写了，之后秒了 C 题，但是复杂度需要控制到线性，和 xzl 讨论了一下，但是还没有键盘，继续想题，无果。后期敲完了 C，摸鱼。

**孙亮亮：**SPFA 已死，能用 Dijkstra 就不用 SPFA。

**薛振梁：**这次比赛前期还算顺利，到中期就开始日常卡题。主要是 I 题的字符串和 B 题的线性基求交，属于基本功不牢。此外，代码正确性不够高，因此中期的题目提交过多。今后还是要复习基础算法，平时要多写一些不太熟悉的算法保证手感。

***

### 解题报告

#### A. Meeting

**情况**　通过

**题意**　给定一棵 $n$ 个点的树，并且指定树上 $K$ 个节点，求出树上一个到 $K$ 个点的最远距离最小的点。输出这个最远距离。$n \leqslant 10^5$。

**题解**　求出以这 $K$ 个点中的两个点为端点的直径即可。

<hr />
#### B. Xor

**情况**　补题通过

**题意**　给定 $n$ 个集合，排成一个序列。有 $q$ 次询问，每次询问一个区间 $[l,\ r]$ 以及一个整数 $x$，问这个区间内的所有集合是否能够都异或出 $x$。$n,\ q \leqslant 50000$，所有整数均为 $32$ 位整数。

**题解**　考虑用线段树维护区间异或基。建树时将左右儿子的线性基求交即可，线性空间求交的复杂度为 $\mathrm O(K^2)$，$K$ 为线性空间的维度。

<hr />
#### C. Sequence

**情况**　通过（-2）

**题意**　给两个序列 $a$，$b$，求一个区间 $[l,\ r]$，使得 $\min(a[l...r])×\mathrm{sum}(b[l...r])$ 最大。

**题解**　考虑单调栈算出每个 $a_i$ 为最小值的区间，然后只需要找这段区间中 $b$ 区间和的最大值及最小值即可，在维护单调栈的过程中立即计算该区间答案，就可以线性算出 $b$ 在区间内的前缀最值。

<hr />
#### D. Triples I

**情况**　通过（-1）

**题意**　输入 $a$，输出 $n$ 个 $3$ 的倍数，使得这些数的按位或是 $a$，要求 $n$ 最小，保证有解。

**题解**　考虑到 $2^\mathrm{odd}\equiv 2 \pmod 3,\ 2^\mathrm{even}\equiv 1 \pmod 3$ ，那么输出的数字在奇数，偶数位上的 $1$ 的个数 $a$，$b$ 满足 $a-b$ 是 $3$ 的倍数，$3$ 个奇数位的数字是 $3$ 的倍数，$3$ 个偶数位的数字也是，那么只需要考虑 $a \bmod 3$ 个奇数位和 $b \bmod 3$ 个偶数位，用尽量少的数覆盖这些位，通过对九种情况分类讨论，都可以在两个数以内满足题意。

<hr />
#### E. Triples II

**情况**　补题通过

**题意**　输入 $a$，$n$，问使得 $x_1 \operatorname{or} x_2 \operatorname{or} x_3 \operatorname{or}...\operatorname{or} x_n=a$ 的方案数有多少，要求 $x_i$ 是 $3$ 的倍数。

**题解**　同上题，对每一位分奇偶，容斥计算只有 $x$ 个奇数位，$y$ 个偶数位但不要求或出来每一位都是 $1$ 的方案数，并且每个 $x$，$y$ 之前有一个组合数的系数。上述方案数是挑一个数字只有这些位并且是 $3$ 的倍数的方案数的 $n$ 次方。

<hr />
#### F. Merge

**情况**　补题通过

**题意**　给一个排列，有两种操作，询问某个位置的值，对 $[1,\ m]$ 和 $[m+1,\ r]$ 区间进行一次归并。

**题解**　题目中 $l=1$，把序列划分成若干段，每段开头是这段的最大值，并且要求最长。那么一次归并就是按照开头排序。接下来维护这些段，对于一次归并，把 $r$ 所在段落中 $r$ 之后的切下来，$m$ 所在段落中 $m$ 之后的按照定义划分为若干段，接下来把这若干段并到之前按照开头排好序的段落里就是这个操作的结果，因为按照定义，开始时按照开头排好序的，插入之后也是。只需要用平衡树维护不同的段的顺序，再用平衡树维护段内都有什么元素。（好像复杂度假了）

<hr />
#### G. Tree

**情况**　补题通过

**题意**　给定一棵 $n$ 个节点的树，以及 $q$ 次询问，每次询问给出一棵大小为 $m$ 的树，问原树中有多少个连通块与询问的树同构。$n \leqslant 2000$，$q \leqslant 10000$，$m \leqslant 12$。

**题解**　考虑到询问的树不是很大，那么询问可能涉及到的本质不同的树也不是很多，因此暴力枚举原树中的所有大小不超过 $12$ 的连通块做树哈希。每次询问时，枚举询问树的树根做树哈希，到原树中的哈希表中查询即可。

<hr />
#### I. String

**情况**　通过（-6）

**题意**　问一个长度为 $n$ 的字符串中有多少本质不同的子字符串。两个字符串不同当且仅当第一个字符串与第二个串的正串和反串均不相同。$n \leqslant 2×10^5$。

**题解**　考虑将原串反转后接到原串后，求出其本质不同的子串个数 $s$，此外再求出原串中本质不同的回文子串个数 $p$，答案为 $(s + p) / 2$。

<hr />
#### J. Free

**情况**　通过（-2）

**题意**　给一个 $n$ 节点无向联通图，求从 $s$ 到 $t$ 可以将 $k$ 条边修改为 $0$ 的最短路径。

**题解**　考虑修改 SPFA 状态和松弛方程，结果 TLE 了，出题人毒瘤。于是做 $k$ 次 Dijkstra。

<hr />
#### K. Number

**情况**　通过（-2）

**题意**　给一个数字串求 $300$ 倍数的字串个数。

**题解**　$300$ 倍数有两种，一种是 $0$ 一种是以 $00$ 结尾的数，枚举以 $00$ 为结尾的数，前面的数字和应为 $3$ 的倍数，于是用 `cnt[i]` 表示当前有多少个后缀的数字和 $%3=i$，这样只剩下 $00$ 和 $0$ 没统计，单独统计一下即可。