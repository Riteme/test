<br /><center class="subtitle">Fudan ICPC Summer Training Camp 2019</center>

# 牛客网第六场训练报告

<br />
<center>[Fudan U2] 刘明君、孙亮亮、薛振梁</center>
<center>2019 年 8 月 3 日</center>
<br />

### 概况

比赛中通过 7 题，赛后补 3 题，总共通过 10 题。

### 比赛过程

<pre class="replay">
|0........|30.......|60.......|90.......|120......|150......|180......|210......|240......|270...... (min)
        J                D                      x    C                         f       G           h [lmj]
     x  J                                            C             E              g                h [sll]
       A         B       c                                        xE                               f [xzl]
*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^
 x   Wrong Answer / Presentation Error              !   Runtime Error
 +   Time Limit Exceeded                            =   Memory Limit Exceeded
A-N  Accepted                                      a-n  可做但未通过 / 弃题
</pre>

### 总结

**刘明君：**开场看来了 F 和 G，感觉 G 高论，就没有着急写暴力。随便写了一个 D 的暴力居然过掉了。然后和另外两人讨论了一下 C，比较容易处理，但还是浪费了太长的时间。中场想出了 F，但是并没有特别想清楚，搞了一个不好写的做法就不管了。4h 时候抢了 sll 的键盘写 G，交了一发暴力过掉了。

**孙亮亮：**G 题没敢写暴力想了一个复杂的乱搞还没写出来，以后要勇于尝试暴力。

**薛振梁：**这一次发挥比较良好，全程基本没有出现失误，需要继续保持。后期明显实力不足，想题速度不够快，代码能力也不够强，主要是实力还不够。

***

### 解题报告

#### A. Garbage Classification

**情况**　通过

**题意**　给定一堆垃圾，以及每种垃圾所述的分类（有害垃圾、湿垃圾、干垃圾），按照规则区分出这一堆垃圾的分类。

**题解**　模拟即可。

<hr />
#### B. Shorten IPv6 Address

**情况**　通过

**题意**　给定一个 IPv6 的字符串，每个子段内可以去掉前缀 `0`，并且至多一段连续的 `0` 可以缩写为 `::`，问这个 IPv6 的地址最短的表示方法。

**题解**　枚举是哪一段 `0` 被缩写为 `::`，将所有可能的方案生成后取最优者。

<hr />
#### C. Palindrome Mouse

**情况**　通过（-1）

**题意**　给一个字符串，问这个串的回文子串集合中，有多少对子串 $x,\ y$ 满足 $x$ 是 $y$ 的子串，不考虑 $x=y$ 的情况。

**题解**　先建出回文树，对每个点，不断向 $\mathrm{fail}$ 上跳能找到所有包含这个子串的结尾字符的子回文串，这些都是对答案有贡献的，再加上这个点回文树上的父亲的所有 $\mathrm{fail}$，及父亲的父亲的 $\mathrm{fail}$……，但是不计重复，所以就是 $\mathrm{fail}$ 树上面树链的并，要求支持加入一条链，删除刚刚加入的那条链，查询并的大小。考虑按照 DFS 序大小维护一个 `set`，那么新加的链对答案贡献就是 `set` 前后一个点与他的 LCA 中比较深的那个到他的一段，删除时也刚好是把这一段删掉。类似于虚树的构造。

<hr />
#### D. Move

**情况**　通过

**题意**　装箱问题，有 $k$ 个大小相同的箱子，装箱的策略是贪心装当前箱子能装的最大的物品，如果不行就换下一个箱子，直到装完。问箱子大小最小是多少。

**题解**　此题没有二分性质。箱子的下界是 $\sum v_i/k$，从这个大小开始枚举，每次暴力用 `set` 找当前放进的物品，可以证明复杂度是 $\max \{v_i\}\cdot n\log n$。

<hr />
#### E. Androgynos

**情况**　通过（-1）

**题意**　给定 $n$，要求构造一个图，满足这个图和自己的补图同构，并且输出证明同构的点置换。$n \leqslant 2000$。

**题解**　首先我们知道 $n$ 必须满足 ${n \choose 2}$ 是 $2$ 的倍数，否则无法构造。那么可以发现 $n$ 模 $4$ 只能等于 $0$ 或 $1$。首先考虑 $n = 4k$ 的情况。对于 $n = 4$ 手动构造一条链即可，并且将链两端划入 $A$ 集合，其余点划入 $B$ 集合。注意 $A$ 集合是一个独立集，$B$ 集合是一个团。这样取补图之后，$A$、$B$ 之间的角色就会对调。对于 $k > 1$ 的情况，我们首先分为 $\lfloor k / 2 \rfloor$ 和 $\lceil k / 2 \rceil$ 两部分分治，然后将一边的 $B$ 集合中的所有点与另外一边的所有点相连，不难验证这样的图取反后是与原图同构的。之后将两边的 $A$ 集合并起来，$B$ 集合也并起来，作为新图的 $A$、$B$ 集合。对于 $n = 4k  + 1$ 的情况，最后一个点与前 $4k$ 个点递归构造的图中的 $A$ 集合相连即可。取补图时，只要每 $4$ 个点内部轮换即可。

<hr />
#### F. K-ary Heap

**情况**　补题通过

**题意**　用数组表示 $K$ 叉小根堆，现给出一个长度为 $n$ 的合法的 $K$ 叉堆序列 $a_i$，问有多少个字典序更小的长度为 $n$ 的合法的 $K$ 叉堆序列。$n,\ K \leqslant 3000$。

**题解**　首先我们可以算出大小为 $n$ 的合法 $K$ 叉堆有多少种，记为 $f(n)$。然后枚举前缀 $i$，计算前 $i - 1$ 个位置相同，第 $i$ 个位置小于 $a_i$ 的方案数。这里有一个小技巧，由于我们统计的是小根堆的方案数，所以我们可以考虑计数不合法的方案数，这样就不用枚举第 $i$ 个元素是什么了，直接以 $a_i$ 为限制即可。不难发现固定前 $i$ 个元素后，原 $K$ 叉树变为一堆小子树，设有 $k$ 个，每个子树有一个子树大小 $s_j$ 和子树父亲权值 $v_j$，要求每棵子树 $j$ 内部的权值均大于 $v_j$ 的方案数。这个计算可以先对 $v_j$ 排序，使其按照递减顺序枚举，然后易知答案为：
$$
\sum_{j=1}^k {n - v_j - \sum_{l=1}^{j-1}s_l \choose s_j} f(s_j)
$$
再使用基数排序，我们可以在 $\mathrm O(n^2)$ 的总时间复杂度内算出不合法的方案数。

<hr />
#### G. Is Today Friday?

**情况**　通过

**题意**　给 $100000$ 个星期五，但是先把 $0-9$ 映射为 $A-J$ ，然后给出的是加密后的字母日期，求字典序最小的映射，或者判断无解。

**题解**　先去重，然后出现在月份十位或者日期十位上的字母只能是 $0/1$ 或者 $0/1/2/3$，暴力枚举所有剩下的全排列，判断是不是星期五。

<hr />
#### H. Train Driver

**情况**　补题通过

**题意**　三个人在一张边权是 $1$ 的图上边要会合，三个人确定了起点之后会按最优策略找到一个点使得三个人走的距离和最小。两个人的起点从 $A$ ($|A|<20$) 中等概率选，第三个人从所有点中等概率选。问期望的距离和。

**题解**　枚举前两个人的起点，那么需要对所有点求如果这个点是第三个人的起点，那么总的距离和是多少。考虑把每个点的初始距离设置成前两个人到这个点的距离，加到队列里面，然后跑最短路，得到的每个点的距离，就是答案，求和后除以 $|A|\cdot|B|\cdot n$ 就是答案。

<hr />
#### I. Can They Go to Galar?

**情况**　补题通过

**题意**　给一颗仙人掌，每条边有一个权值，开始 $1$ 号点是好的，每一个回合，如果一个点在上一个回合变成了好的，那么他周围的不是好的点，有这条边的权值的概率变成好的，重复这个过程到无穷，问期望有多少个点是好的。

**题解**　如果是树的情况就是每个点父亲的期望乘以到父亲的边权。仙人掌的情况如果不在环上和树一样，如果在环上，那么一定是被离 $1$ 号点最近的那个点染成好的。这种由两种情况，一种是在环上顺时针过来，一种是逆时针过来，那么期望就是 $1-(1-p_1)(1-p_2)$，建出圆方树处理每个点的期望即可。

<hr />
#### J. Upgrading Technology

**情况**　通过（-1）

**题意**　有 $n$ 个技能，每个技能有 $m$ 个等级，第 $i$ 个技能从 $j-1$ 级升级到 $j$ 级需要 $c[i][j]$ 的代价，如果所有 $n$ 个技能都在 $j$ 级以上将获得 $d[j]$ 的收益，求最大收益。

**题解**　枚举最低级别的技能的级别 $k$，额外收益为 $\sum_{j = 1}^k d[j]$，每种技能取高于 $k$ 级的最小代价级别即可，另外要强制让其中一个技能恰好为 $k$ 级。