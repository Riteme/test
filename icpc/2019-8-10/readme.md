<br /><center class="subtitle">Fudan ICPC Summer Training Camp 2019</center>

# 牛客网第八场训练报告

<br />
<center>[Fudan U2] 刘明君、孙亮亮、薛振梁</center>
<center>2019 年 8 月 10 日</center>
<br />

### 概况

比赛中通过 7 题，赛后补 3 题，总共通过 10 题。

### 比赛过程

<pre class="replay">
|0........|30.......|60.......|90.......|120......|150......|180......|210......|240......|270...... (min)
   e                            J          E                               I          =++ +x++  x++d [lmj]
   B     x   C                                              h                                      f [sll]
    G       x       x     A           !   xE                h                                      f [xzl]
*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^
 x   Wrong Answer / Presentation Error              !   Runtime Error
 +   Time Limit Exceeded                            =   Memory Limit Exceeded
A-N  Accepted                                      a-n  可做但未通过 / 弃题 / 屯题
</pre>

### 总结

**刘明君：**比赛时一眼看出了 E 和 I，过程中也口胡了 D 和 H，一度认为是正确的，但是过程中多次出现自己的算法假了的情况，要思考清楚。

**孙亮亮：**F 题差一点点就想到了，下次加油！

**薛振梁：**H 题最开始想到的算法方向偏了，写到一大半时发现算法假了，做了无用功。主要是因为想算法前对问题的理解还不够深入，没能正确理解 H 题的本质，正解算法并不是很难，以后想题时还要加强验证算法的能力。

***

### 解题报告

#### A. All-one Matrices

**情况**　通过

**题意**　给定一个 $n×m$ 的 `01` 矩阵，问其中有多少个极大全 `1` 子矩阵。极大矩阵意味着不能被其它全 `1` 子矩阵所包含。$n,\ m \leqslant 3000$。

**题解**　考虑枚举子矩阵的右下角，首先要用单调栈维护所有能够向上向左能扩展的范围。考虑每次弹栈时，说明被弹栈的位置上面、左边、下面均被阻挡，此时只有右侧在对应范围内有非 `0` 元素，就说明找到了一个全 `1` 子矩阵。时间复杂度 $Θ(nm)$。

<hr />
#### B. Beauty Values

**情况**　通过

**题意**　给出一个序列，求所有区间的不同的数字个数之和。

**题解**　考虑每个数 $a_i$ 的贡献是 $(i - \mathrm{lst}[i])\cdot(n-i+1)$（$\mathrm{lst}[i]$ 是 $a_i$ 上次出现的位置）。

<hr />
#### C. CDMA

**情况**　通过

**题意**　构造一个 $m×m$ 的矩阵，元素皆为 $1$/$-1$，使得任意两个行向量的点积为 $0$。

**题解**　$m = 2$ 时解为：
$$
\left[\begin{matrix}
1 & -1 \\
1 & 1
\end{matrix}\right]
$$

$m>2$ 时，先求出 $m/2$ 的解，在其右侧、下方复制一遍，并在右下角取其相反数即可。例如，$m=4$ 时解为：

$$
\left[\begin{matrix}
1  & -1  & 1  & -1 \\
1   & 1 &  1  & 1 \\
1 &  -1&   -1 &  1 \\
1  &  1 &  -1  & -1
\end{matrix}\right]
$$


<hr />
#### D. Distance

**情况**　补题通过

**题意**　在一个 $n×m×h$ 的立方体网格内，执行 $q$ 次操作。每次操作可以标记一个格点，或者询问所有被标记的格点到给定点最小 Manhattan 距离是多少。$n×m×h,\ q \leqslant 10^5$。 

**题解**　考虑如果没有加点操作，则使用多源 BFS 即可算出每个格点的答案。对于加点操作，我们可以采用定期分块重构的方法，可以做到 $\mathrm O(q\sqrt{nmh})$ 的时空复杂度。

<hr />
#### E. Explorer

**情况**　通过

**题意**　已知图中有 $n$ 个点和 $m$ 条边，每条边只会在时间 $[l_i,\ r_i]$ 内有效，问有多少个时间点使得 $1$ 号点和 $n$ 号点是连通的。$n,\ m \leqslant 10^5$，$1 \leqslant l_i,\ r_i \leqslant 10^9$。

**题解**　线段树分治加可撤销并查集即可。时间复杂度 $\mathrm O((n + m)\log n \log W)$。

<hr />
#### F. Flower Dance

**情况**　补题通过

**题意**　在二维平面上给出 $n$ 个点，求有多少个 $(i,\ j,\ k,\ l)$ 满足点 $i$、点 $j$、点 $k$ 和点 $l$ 构成一个三角形严格包含另一个点。

**题解**　枚举中心点 $i$，对其余点以 $i$ 为中心极角排序，发现其余三个点如果能完全包含 $i$，必然不可能三个点都在 $x$ 轴上方或者下方，于是枚举单独在一侧的点，并利用前缀和求另一侧合法的点对。

<hr />
#### G. Gemstones

**情况**　通过

**题意**　给定一个长度为 $n$ 的字符串，每次可以消去字符串中相连的三个相同的字符，消去后字符串前后又会接在一起。问这样的操作最多能做多少次。$n \leqslant 10^5$。

**题解**　从前往后扫一遍，贪心地做消去即可。

<hr />
#### H. How Many Schemes

**情况**　补题通过

**题意**　给一棵 $n$ 个点的树，树上每条边有一个字符集 $Σ_i$，再给出 $m$ 个字符串 $s_i$，以及 $q$ 次询问。每次询问给出 $u$、$v$，问从 $u$ 走到 $v$ 的简单路径上，如果每条边都从字符集 $Σ_i$ 中选出一个字符，使得路径组成一个字符串，并且该字符串包含 $m$ 个字符串中的任意一个字符串，问这样的选字符的方案有多少种。答案对 $998244353$ 取模。$n \leqslant 2500$，$q \leqslant 5000$，$Σ = \max\{|Σ_i|\} \leqslant 26$，$T = \sum |s_i| \leqslant 40$。

**题解**　考虑只有一组询问的情况：首先建出 $m$ 个串的 AC 自动机，然后就可在自动机上做 DP 从 $u$ 一直推到 $v$ 的答案。注意到对于特定的字符集，这个 DP 实际上可以被写成矩阵乘法的形式，并且 DP 数组可以被视为一个至多 $T$ 维的向量。考虑到向量和矩阵乘法仅需 $\mathrm O(T^2)$ 的时间，因此对树进行树链剖分，对每条链存一个前缀积和一棵线段树来计算区间积。每次询问时，除了最后两个端点在一条重链上相遇的情况，其余情况均是查询前缀积。因此时间复杂度为 $\mathrm O(nT^3 + qT^2\log n)$。

<hr />
#### I. Inner World

**情况**　通过

**题意**　给 $n$ 棵树，开始都只有标号为 $1$ 的根，之后每次对一个区间的 $u$ 号点增长出 $v$ 号点作为儿子，保证 $v$ 是互不相同的，最后询问一个区间内的 $x$ 的子树大小之和。

**题解**　先离线出树的结构，然后对将 $[l,\ r]$ 看成时间进行处理，每次处理相当于在树剖上面到根的链上面把斜率加减 $1$ 或者询问一个点当前时间累积的截距有多少。

<hr />
#### J. Just Jump

**情况**　通过

**题意**　现在在 $0$ 号点上，每次跳跃至少向后跳 $d$ 步，问跳到 $L$ 的方案数，但是要求是在第 $t_i$ 次跳时，不能跳到第 $p_i$ 号点上。

**题解**　DP，算出第一次踩到某个雷的方案数，然后再前缀和转移时扣掉这些方案。