<br /><center class="subtitle">Fudan ICPC Summer Training Camp 2019</center>

# 牛客网第九场训练报告

<br />
<center>[Fudan U2] 刘明君、孙亮亮、薛振梁</center>
<center>2019 年 8 月 15 日</center>
<br />

### 概况

比赛中通过 6 题，赛后补 3 题，总共通过 9 题。

### 比赛过程

<pre class="replay">
|0........|30.......|60.......|90.......|120......|150......|180......|210......|240......|270...... (min)
                E                                   H            xC                                i [lmj]
           xB                                       H                                              i [sll]
     D                    x           =                  x   J                 x                   i [xzl]
*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^*^^^^^^^^^
 x   Wrong Answer / Presentation Error              !   Runtime Error
 +   Time Limit Exceeded                            =   Memory Limit Exceeded
A-N  Accepted                                      a-n  可做但未通过 / 弃题 / 屯题
</pre>

### 总结

**刘明君：**思路不够灵活，A 题没有想到 CRT，I 题也没有想到可以类欧处理。

**孙亮亮：**I 题认定了数位 DP 的算法，下次应该认真思考后再确定中后期题目的算法。

**薛振梁：**这一场比赛思路放得不是很开。第一题虽然想到循环节，偏偏没想到 CRT。J 题思考得不是很清楚，并且写的时候没有注意到空间限制，浪费了前期的时间。I 题就一直在想数位 DP 的思路，并没有意识到数位 DP 难以处理进位的事情。

***

### 解题报告

#### A. The Power of Fibonacci

**情况**　补题通过

**题意**　求 $\sum_{i=0}^n F_i^m \pmod {10^9}$，其中 $F_i$ 为斐波那契数列。

**题解**　可以把模数质因数分解，然后对 $2^9$ 和 $5^9$ 找循环节，然后 CRT 合并。

<hr />
#### B. Quadratic Equation

**情况**　通过

**题意**　给出 $b$，$c$，$p$ 求满足 $x+y \equiv b \pmod p$，$xy \equiv c \pmod p$ 的 $x$，$y$。

**题解**　把 $y$ 用 $x$ 表示可以得到一个一元二次同余方程，求二次剩余即可。

<hr />
#### C. Inversions of All Permutations

**情况**　通过

**题意**　给一个序列，求：
$$
\sum_{r_i \text{ 为 } a_i \text{ 的排列}} b^{(r_i \text{ 的逆序对数量})} \pmod {10^9+7}
$$

**题解**　考虑把比 $a_i$ 小的数放完了，现在放若干个 $a_i$，产生的贡献是 $b$ 的若干个幂次求和，并且不同的 $a_i$ 产生的贡献是独立的，那么乘起来就可以，用 $\mathrm O(n^2)$ 的 DP 算出这个贡献就水过去了。

<hr />
#### D. Knapsack Cryptosystem

**情况**　通过

**题意**　给定至多 $36$ 个非负整数和 $s$，要求一个 01 背包使得背包总和为 $s$。

**题解**　分两个 $18$ 个暴力计算然后 meet in the middle 即可。

<hr />
#### E. All Men are Brothers

**情况**　通过

**题意**　定义认识关系是等价关系，开始所有人不认识，每次加一条边，问当前的图上四元反链的个数。

**题解**　并查集维护每个块的大小，数出有多少从不同块中挑出两个人和四个人的方案数。

<hr />
#### F. Birthday Reminders

**情况**　补题通过

**题意**　一个人有 $n$ 个朋友，每个人会在 $t_i$ 时刻祝福主人公 ，然后提醒另一个人在 $t_i+1$ 时刻祝福主人公，一个人只会祝福主人公一次，问在遍历每个人提醒的人是谁的情况下，主人公有多少种受到祝福的种类。两个情况不同当且仅当某一天主人公受到的祝福数量不同。

**题解**　考虑 $\mathrm{dp}[i][j][k]$ 表示前 $i$ 天共有 $j$ 个人祝福，并且第 $i$ 天的祝福数量是 $k$ 的方案数，转移的时候枚举下一天祝福的人数，要求人数不能太少，少于前 $i+1$ 天本来就祝福主人公的数量，不能多于当天本来就祝福主人公的人数加上 $k$。

<hr />
#### H. Cutting Bamboos

**情况**　通过

**题意**　给出 $n$ 个韭菜，每个韭菜高 $h_i$，求 $[l,\ r]$ 区间内的韭菜，割 $y$ 次每次割的总长相同，第 $x$ 次割的高度。

**题解**　显然要求是砍了第 $x$ 的高度之后，剩余总高为 $(x-1)\cdot \mathrm{sum}/y$，在可持久化线段树上二分得到第 $x$ 次高度的整数部分，就可以求出真实的高度值。

<hr />
#### I. KM and M

**情况**　补题通过

**题意**　给定 $n$ 和 $m$，求 $\sum_{k = 1}^n (km) \operatorname{and} m \pmod{10^9+7}$。

**题解**　枚举 $m$ 二进制上所有 $1$ 的位置。假设现在枚举的是第 $i$ 位，则可以通过计算 $\sum_{k = 1}^n \lfloor km / 2^{i - 1} \rfloor$ 就得到了去掉 $m$ 后 $i - 1$ 位的贡献，这个和可以通过类 Euclid 算法得到。

<hr />
#### J. Symmetrical Painting

**情况**　通过

**题意**　给定 $n$ 个并排的、宽度为 $1$ 的竖条矩形，第 $i$ 个矩形的纵坐标范围为 $[L_i,\ R_i]$，且矩形内部涂黑。现问最少将多少个 $1×1$ 的黑方块涂白使得剩下的黑色区域存在一个水平的对称轴。$n \leqslant 3×10^5$。

**题解**　题意可以翻译为可以调整 $L_i$ 和 $R_i$ 的值，使得对所有 $i$ 满足 $L_i + R_i$ 为定值。考虑从小到大枚举这个定值，那么对于每一个矩形，需要调整的方块数量可以用四段折线表示。因此使用扫描线维护当前处的折线的斜率和截距，扫描的过程中统计一下最小值即可。