#### B. Enumeration not Optimization

**题意**　给定一个 $n$ 个点 $m$ 条边的无向带权图，定义它的一棵有根生成树的权值为树上边权乘上边的深度的总和。求这张图上所有有根生成树的权值之和对 998244353 取模后的值。$n \leqslant 12$，$m \leqslant 1000$。

**题解**　记 $f[S][i][j]$ 表示点集为 $S$，树根为 $i$，并且 $i$ 的深度为 $j$ 的答案。DP 转移的时候枚举 $i$ 的一棵子树的点集为 $T$，然后考虑子树的树根到 $i$ 的边权的贡献。为了能够计算贡献，记 $G[S][i]$ 表示点集为 $S$，树根为 $i$ 的有根生成树的总数。计算需要用到另外一个 DP：$g[S][i][j]$ 表示点集为 $S$，树根为 $i$，且 $i$ 的儿子有 $j$ 个。DP 的过程也是枚举子树的点集 $T$。需要注意的是，有 $j$ 个儿子的生成树会被算入 $j!$ 次，所以需要将 $g[S][i][j]$ 除以 $j!$ 后再加到 $G[S][i]$ 中。时间复杂度为 $O(2^nn^3 + 3^nn^2)$。

<br />

#### F. Typing Practice

**题意**　有 $n$ 个字符串（串的总长度不超过 $m = 10^5$），以及一个目标串９长度不超过 $10^5$），和 $q$ 次操作。每次操作可以在目标串末尾加上一个字符，或者删去一个字符。问操作之后还需要在目标串后面至少加入多少个字符，才能使得 $n$ 个字符串中任意一个字符串成为目标串的后缀。$n \leqslant 4$。

**题解**　将 KMP 的 DFA 完整地构造出来，然后进行匹配即可。时间复杂度 $\Theta(m|\Sigma|)$，$\Sigma$ 为字符集。

<br />

#### H. Prefix Sum

**题意**　给定一个长度为 $n$ 初始值均为 0 的序列 $A[1..n]$，有 $q$ 次操作，每次操作为以下两种操作之一：

* 给定 $i$ 和 $v$，将 $A[i]$ 加上 $v$。
* 给定 $i$ 和 $k$，计算 $A$ 的 $k$ 次前缀和中第 $i$ 个位置上的值。

$n,\,q \leqslant 10^5$，$k \leqslant 40$。

**题解**　由于 $k$ 非常小，所以可以考虑分步计算。前缀和的本质就是一个点到另外一个点的路径总数。从 $x$ 到 $y$ 的所有路径可以先计算从 $x$ 到中点 $z$，在从 $z$ 到 $y$ 而得出。因此使用分块，令块大小为 $S$，并且为每个块计算块前面到到块起点的所有贡献。对于修改操作，对 $n / S$ 个块都进行这样的操作。对于查询操作，分为两个部分：一部分是块开头的所有贡献，另一部分是块内的所有贡献。因此单次修改的复杂度为 $nk / S$，查询的复杂度为 $S + k$，当 $S \approx \sqrt {nk}$ 时的时间复杂度为 $O(q \sqrt{nk})$。