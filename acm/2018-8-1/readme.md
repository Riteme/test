#### A. Archery Tournament

**题意**　有 $q$ 个操作，操作有以下两种：

* 给定 $x$ 和 $y$，添加一个圆心为 $(x,\,y)$，半径为 $y$ 的圆。保证该圆与当前存在的圆不相交（但可以相切）。
* 给定 $x$ 和 $y$，输出包含点 $(x,\,y)$ 的圆的编号，并将其删除。如果不存在这样的圆，则什么都不做。

$n \leqslant 2 \times 10^5$，$|x|,\,|y| \leqslant 10^9$。

**题解**　关键点：穿过一条竖线的圆数量并不多。设 $W = 10^9$ 表示纵坐标上界，那么对于穿过同一条线的一系列圆，后一个圆的半径一定大于前一个圆的直径。所以这样的圆的个数为 $O(\log W)$ 。

要判断一个点是否在圆内，首先要满足横坐标在圆所覆盖的区间内。可以使用线段树套平衡树来枚举所有横坐标满足要求的圆：线段树维护圆的左端点，平衡树维护圆的右端点。然后直接检查纵坐标是否也满足要求。那么每次操作的时间复杂度为 $O(\log  n \log W)$。

#### B. Box

**题意**　问能否在 $w \times h$ 的方格纸上剪出一块（边界与方格纸边界平行）能够折成 $a \times b \times c$ 的长方体的纸板。

**题解**　手动枚举长方体所有的展开方式，计算长和宽，然后看能否放入网格纸。

#### C. Connections

**题意**　给定一个 $n$ 个点 $m$ 条边的强连通图，要求留下 $2n$ 条边，使得剩下的图依然是强连通的。$n,\,m \leqslant 10^5$，$m > 2n$。

**题解**　做法 1：稍微修改一下 Tarjan 强连通分量算法，在更新 `low` 数组的时候同时记录当前点最高的一条返祖边。最后保留 DFS 树边和记录的返祖边即可。

做法 2：将所有边正着连和反着连，得到两张图，分别从 $1$ 开始 DFS 或者 BFS 得到生成树，保留两棵生成树的树边。

时间复杂度均为 $\Theta(n + m)$。

#### J. Journey from Petersburg to Moscow

**题意**　给定一个 $n$ 个点 $m$ 条边的带权无向图，以及一个整数 $K$。图上路径的长度定义为路径中最大的至多 $K$ 条边的权值之和。求从 $1$ 到 $n$ 的最短路。$n,\,m \leqslant 3000$，$K <  n$。

**题解**　如果答案路径不足 $K$ 条边，那么直接求最短路就可以得到长度。

否则答案路径至少有 $K$ 条边。枚举它的第 $K$ 大的边是多少，假设其边权为 $w$。然后将图中边权不超过 $w$ 的边的边权变为 $0$（即假设我们不考虑它们），其余边的边权全部减去 $w$，然后跑最短路。如果当前枚举的边正好是答案路径上边权第 $K$ 大的边，那么再补上 $w \cdot K$ 就是答案。

而如果不是这样，分两种情况考虑：

* $w$ 大于第 $K$ 大边权：那么补上 $w \cdot K$ 会使答案不优。
* $w$ 小于第 $K$ 大边权：计算时答案路径会加入其它的边，使结果不优。

因此只有恰好枚举到的时候会给出答案。使用堆优化的 Dijkstra 算法，时间复杂度 $O(m^2 \log n)$。

#### L. Laminar Family

**题意**　给定一棵 $n$ 个点的树，以及 $m$ 条路径，判断是否有两条路径相交（包含不算相交）。$n,\,m \leqslant 10^5$。

**题解**　将所有路径按长度从长到短排序，因为短的路径不可能包含长的路径。然后给每条路径赋一个随机权值。按照顺序加入路径，首先判断它是否与之前的路径有交，那么要求路径上所有点的权值一样。检查非常简单：求出路径和然后和路径长度乘以路径上某个节点的权值的乘积做比较，如果不同则说明很大概率与之前某条路径相交。然后将自己的随机权值加到树上。使用树链剖分加线段树从而达到 $O(n \log^2 n)$ 的时间复杂度。