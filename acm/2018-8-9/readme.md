#### A. Minimum Cost Perfect Matching

**题意**　给定 $n$，构造一张 $2n$ 个节点的完全二分图：左右两边各有 $n$ 个节点，编号依次为 $0..n - 1$。连接编号为 $x$ 和 $y$ 的边的边权为 $x \land y$（按位与）。求二分图的最小权完美匹配。

**题解**　从大到小考虑每个编号：将自己和自己的反码配在一起即可。显然最后大家都能配到，并且总权重为 0。时间复杂度 $\Theta(n)$。

#### I. Tree Subset Diameter

**题意**　给定一棵 $n$ 个节点的树，定义一个点集的直径为点集中最远的两个点之间在树上的距离。问直径为 $d$ 的点集总数。答案对 $10^9 + 7$ 取模。$n \leqslant 10^5$。

**题解**　虽然一个点集的直径可能不唯一，但是重心唯一。需要注意这个重心可能在一条边上。

因此我们可以从重心来考虑答案。如果我们能够计算出从重心出发走至多 $d/2$ 步能到达多少节点，以及距离重心为 $d/2$ 步的节点的个数，就可计算出以这个点为重心的点集数量。

将树变为有根树，我们只需要计算出每个点向下走能到达的节点个数，这个可以使用长链剖分 + DP 的方法在 $\Theta(n)$ 的时间内计算出来。另外一部分是往上走的部分，注意可能走到某个祖先处又转而向下走。这相当于将每个节点的信息传递给某个子树中特定深度范围处的所有节点。子树范围可以使用 DFS 序，然后就变成了二维偏序问题：横轴为 DFS 序，纵轴为深度，每次更新就是修改一个矩形内的所有值。使用树状数组离线处理即可。

时间复杂度 $O(n \log n)$。

#### J. Sudoku Subrectangles

**题意**　给定一个 $n \times m$ 的矩阵，矩阵中每个元素处有一个英文字母（大写或者小写，所以 $|\Sigma| = 52$）。问有多少个子矩阵，满足对于每一行和每一列，都没有出现重复的字母。$n,\,m \leqslant 1000$。

**题解**　首先预处理出每个位置向左和向上最长距离，满足在这个距离内没有出现重复字母。然后枚举子矩阵的一边长度（最多为 $|\Sigma|$），以及一个角的坐标，然后使用单调队列来维护被枚举的一边的一侧最多能够走多远，从而可以计算出在这个位置的子矩阵数量。时间复杂度 $\Theta(nm|\Sigma|)$。